<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - EventHub</title>
    <link rel="stylesheet" href="style3.css">
    <style>
        /* Add a little top padding to the body to prevent navbar overlap */
        body {
            padding-top: 70px;
        }
        /* Make tables look better in dark mode */
        .dark-mode .table {
            color: #eee;
        }
        .dark-mode .table-striped>tbody>tr:nth-of-type(odd)>* {
            --bs-table-accent-bg: var(--bs-table-striped-bg, rgba(255, 255, 255, 0.05));
        }
    </style>
</head>

<body class="bg-light">
    <nav class="navbar">
        <div class="container">
            <a class="navbar-brand fw-bold text-primary" href="index.html" style="font-size: 30px;">EventHub</a>
            
            <button class="navbar-toggler" type="button" id="navbarToggle">
                <span>â˜°</span>
            </button>

            <div class="navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item"><a class="nav-link" href="index.html#events">Events</a></li>
                    <li class="nav-item"><a class="nav-link" href="index.html#about">About</a></li>
                    <li class="nav-item"><a class="nav-link" href="index.html#contact">Contact</a></li>
                    <li class="nav-item"><a class="btn btn-outline-danger ms-2" id="logoutButton" href="admin-login.html">Logout</a>
                    </li>
                    <li class="nav-item ms-3">
                        <button id="darkModeToggle" class="btn btn-secondary btn-sm">ðŸŒ™ Dark Mode</button>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h1 class="fw-bold">Admin Dashboard</h1>
            <button class="btn btn-primary fw-semibold">Create New Event</button>
        </div>

        <h2 class="fw-semibold fs-4 mb-3">My Events</h2>

        <!-- Container where event cards will be rendered -->
        <div id="eventsContainer"></div>
 
     </div>
 
     <script>
         // Dark Mode Toggle
         const toggle = document.getElementById('darkModeToggle');
         toggle.addEventListener('click', () => {
             document.body.classList.toggle('dark-mode');
             toggle.textContent = document.body.classList.contains('dark-mode') ? 'â˜€ï¸ Light Mode' : 'ðŸŒ™ Dark Mode';
         });

         // Logout functionality
         const logoutButton = document.getElementById('logoutButton');
         if (logoutButton) {
             logoutButton.addEventListener('click', (e) => {
                 e.preventDefault(); // Prevent default link behavior
                 // In a real app, you'd clear session/local storage
                 // localStorage.removeItem('adminToken');
                 alert("Logging out...");
                 window.location.href = 'admin-login.html'; // Redirect to login
             });
         }
     </script>

   <script>
      // Render participants from localStorage into cards
       const STORAGE_KEY = 'eventhub_participants';

        // define events to display on dashboard (id must match register select option values)
        const EVENTS = [
            { id: 'web-dev', title: 'Web Development Workshop', date: '2025-12-10', location: 'Main Auditorium' },
            { id: 'ai-ml', title: 'AI & Machine Learning Meetup', date: '2025-11-20', location: 'Room 204' },
            { id: 'startup', title: 'Startup Networking Session', date: '2025-12-05', location: 'College Grounds' }
        ];

        function readParticipantsStore() {
            try { return JSON.parse(localStorage.getItem(STORAGE_KEY)) || {}; }
            catch (e) { return {}; }
        }

        function formatDate(iso) {
            try { return new Date(iso).toLocaleString(); }
            catch (e) { return iso; }
        }

        function render() {
            const store = readParticipantsStore();
            const container = document.getElementById('eventsContainer');
            container.innerHTML = '';

            EVENTS.forEach(ev => {
                const participants = store[ev.id] || [];

                const card = document.createElement('div');
                card.className = 'card shadow-sm mb-4';
                card.innerHTML = `
                    <div class="card-header">
                        <h3 class="fw-semibold mb-0">${ev.title}</h3>
                    </div>
                    <div class="card-body">
                        <p><strong>Date:</strong> ${ev.date} | <strong>Location:</strong> ${ev.location}</p>
                        <h5 class="mt-4 fw-semibold">Participants (${participants.length})</h5>
                        <div class="table-responsive">
                            <table class="table table-striped table-hover">
                                <thead>
                                    <tr><th>Name</th><th>Email</th><th>Phone</th><th>Registered On</th></tr>
                                </thead>
                                <tbody>
                                    ${participants.map(p => `
                                        <tr>
                                            <td>${escapeHtml(p.name)}</td>
                                            <td>${escapeHtml(p.email)}</td>
                                            <td>${escapeHtml(p.phone || '')}</td>
                                            <td>${formatDate(p.registeredOn)}</td>
                                        </tr>`).join('') }
                                </tbody>
                            </table>
                        </div>
                    </div>
                `;

                container.appendChild(card);
            });
        }

        // small helper to prevent simple html injection inside table cells
        function escapeHtml(str = '') {
            return String(str)
                .replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;')
                .replace(/"/g, '&quot;')
                .replace(/'/g, '&#39;');
        }

        // initial render
        render();

        // Optional: subscribe to storage events so multiple tabs update automatically
        window.addEventListener('storage', (e) => {
            if (e.key === STORAGE_KEY) render();
        });
   </script>
</body>

</html>
</html>
